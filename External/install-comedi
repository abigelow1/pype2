#!/bin/csh

# install comedi from tar.gz distribution files

echo -n "Install comedi? [y or n]"; set comedi=$<
if ("$comedi" == "n") then
  exit 1
endif

echo -n "Is the kernel configured?? [y or n]"; set kcheck=$<
if ("$kcheck" == "n") then
  echo -n "Configure the kernel, then try again!"
  exit 1
endif

# temp install dir:
set d=/tmp/install.$$

#
# comedi drivers
#

mkdir $d
gunzip < comedi-*.tar.gz | (cd $d; tar xf -)
pushd $d/comedi-*
./configure --prefix=/usr
make
make install
make dev
popd
/bin/rm -rf $d

mkdir $d
gunzip < comedilib-*.tar.gz | (cd $d; tar xf -)
pushd $d/comedilib-*
./configure --prefix=/usr
make
make install
popd
/bin/rm -rf $d
  
/sbin/depmod -a
/sbin/ldconfig

cat <<EOF

************** Jamie says: ***************
Add the following lines at the end of /etc/rc.d/rc.local
(at least for FC2/FC3) to load & configure the comedi
device drivers:

/sbin/modprobe das08
/usr/sbin/comedi_config /dev/comedi0 pci-das08


			Open another window and DO IT NOW, so you don't forget.
EOF
  echo -n "OK???? "
  set foo=$<
  else
  echo "Skipped comedi..."
  endif
endif
